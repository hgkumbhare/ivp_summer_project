import java.awt.Color;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.Scanner;
import javax.imageio.ImageIO;

public class Text2Image {

	public static void text2image(String inputfilename,String outputdirectory) {
		try {
			Scanner scanner = new Scanner(new File(inputfilename));
			System.out.println("getting input");

			int index = 1;
			while (scanner.hasNext()) {
				int i, j;
				int h = 0, w = 0, c;

				h = scanner.nextInt();
				w = scanner.nextInt();
				c = scanner.nextInt();
				System.out.println("yay" + Integer.toString(h)
						+ Integer.toString(w));

				BufferedImage image = new BufferedImage(w, h,
						BufferedImage.TYPE_INT_RGB);
				for (int y = 0; y < h; ++y) {
					for (int x = 0; x < w; ++x) {
						if (c == 3) {
							Color myWhite = new Color(scanner.nextInt(),
									scanner.nextInt(), scanner.nextInt());
							int rgb = myWhite.getRGB();
							image.setRGB(x, y, rgb);
						} else if (c == 1) {
							int val = scanner.nextInt();
							int value = val << 16 | val << 8 | val;
							image.setRGB(x, y, value);
						} else {
							throw new IllegalArgumentException("Invalid Input");
						}
					}
				}
				ImageIO.write(image, "jpg", new File(outputdirectory, Integer.toString(index)
								+ ".jpg"));
				index++;
			}
			scanner.close();
		} catch (Exception e) {
		}
	}

	static public void main(String args[]) throws IOException {
		String inputfilename=args[0];
		String outputdirectory=args[1];
		text2image(inputfilename,outputdirectory);
	}
}
